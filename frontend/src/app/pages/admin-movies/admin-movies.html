<div class="main-container">
  <div class="header-section">
    <h2>Movie Management</h2>
    <span *ngIf="isAdmin" class="admin-badge">ADMIN MODE</span>
  </div>

  <div *ngIf="isAdmin" class="add-form-container">
    <h3>+ Add New Movie</h3>
    <div class="form-inputs">
      <div class="form-row">
        <input type="text" [(ngModel)]="inputTitle" placeholder="Title" class="form-control" style="flex: 2;">
        <input type="number" [(ngModel)]="inputYear" placeholder="Year" class="form-control small">
        <input type="text" [(ngModel)]="inputGenre" placeholder="Genre" class="form-control" style="flex: 1;">
      </div>
      <div class="form-row">
        <input type="number" [(ngModel)]="inputDuration" placeholder="Min" class="form-control small">
        <input type="number" step="0.1" [(ngModel)]="inputRating" placeholder="Rating" class="form-control small">
        <input type="text" [(ngModel)]="inputPoster" placeholder="Poster URL" class="form-control" style="flex: 2;">
      </div>
      <div class="form-row">
        <textarea [(ngModel)]="inputDescription" placeholder="Description..." class="form-control full-width" rows="2"></textarea>
      </div>
      <div class="form-row" style="justify-content: flex-end;">
        <button (click)="onAddMovie()" class="btn-add">Save Movie</button>
      </div>
    </div>
  </div>

  <div class="movies-list">
    <div *ngFor="let movie of movies" class="movie-card">
      <div class="movie-poster">
        <img [src]="movie.posterUrl || 'https://via.placeholder.com/150x220?text=No+Image'">
      </div>

      <div class="movie-details">
        <div style="display: flex; justify-content: space-between;">
           <h3 class="movie-title">{{ movie.name }}</h3>
           <span style="color: gold; font-weight: bold;">‚òÖ {{ movie.rating }}</span>
        </div>
        <p class="description-text">{{ movie.description }}</p>

        <div class="admin-projections-box">
          <h4 class="box-title">SHOWTIMES</h4>
          <div class="current-slots">
            <div *ngFor="let p of movie.projections" class="slot-badge">
              <small style="color: #777;">{{ p.date }}</small> | 
              <strong>{{ p.time }}</strong> | H{{ p.hall_nr }} ({{ p.city }})
              <button (click)="onDeleteProjection(p.id)" class="btn-delete-slot">√ó</button>
            </div>
          </div>   

          <div class="add-slot-form">
            <input type="date" [(ngModel)]="newProjDate" class="mini-input">
            <input type="time" [(ngModel)]="newProjTime" class="mini-input">
            <select [(ngModel)]="selectedHallId" class="mini-input">
              <option [ngValue]="null">Select Hall</option>
              <option *ngFor="let h of halls" [ngValue]="h.id">
                H{{ h.hall_nr }} - {{ h.hall_type }} - {{ h.city }}
              </option>
            </select>
            <button (click)="onAddProjection(movie.id!)" class="btn-save-slot">Add</button>
          </div>
        </div>
      </div>

      <div class="movie-actions" *ngIf="isAdmin">
        <button (click)="onDeleteMovie(movie.id!)" class="btn-delete-movie">Delete Movie üóëÔ∏è</button>
      </div>
    </div>
  </div>
</div>